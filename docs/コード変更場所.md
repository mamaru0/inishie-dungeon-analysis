# 1. ファイルの作成
- `inishie`(仮名)というフォルダーを作成します。
- inishie配下に`inishie.cgi`、`crossdomain.xml`という２つのファイルを作成します。
- inishie.cgiの中身は空です。(「ファイルを読み終わった」というイベントを発生させる為だけに作ります。)
- crossdomain.xmlの中身は以下の通りです。
```xml
<cross-domain-policy>
    <allow-access-from domain="*" />
</cross-domain-policy>
```

# 2. セキュリティ設定の変更
変更目的: セキュリティ制限により、ローカルファイルへのアクセスが制限されるのを防ぐ為です。

- root配下に**crossdomain.xml**というファイルを作ります。ファイルの中身は以下の通りです。
```xml
<cross-domain-policy>
    <allow-access-from domain="*" />
</cross-domain-policy>
```
- Main 204行目: ```Security.loadPolicyFile .. ```に記載されたパスを、crossdomain.xmlのパスに変更します。
```as3
Security.loadPolicyFile("C:/path/to/crossdomain.xml");
```

# 3. トライアルモードに変更
変更目的: サーバーと通信する一部の関数を回避する為。
- Main 34行目: ```public var trial_flag .. ```の値を、```true```に変更します。
```as3
public var trial_flag:Boolean = true;
```

# 4. URLをローカルパスに変更
- Main 30行目: ```public var url:String .. ```に記載されたパスを、**1. メインフォルダーの作成**で作成したrootフォルダーのパスに変更します。
```as3
public var url:String = "C:/path/to/root/";
```
>[!WARNING]
>パスの末尾には、必ず、"/"をつけて下さい。


# 5. サーバー通信部分の補完

- **inishie.cgi**というファイルを作ります。ファイルの中身は空。AccessClass 341行目```this.loader.load(_loc2_);```でcgiファイルを読み込んだ後に、`Event.COMPLETE`というイベントを発生させる為だけに作ります。

- AccessClass 350行目（```loaderCompleteFunc```の最初の行）に、```this.loader.data```を変更するコードを書く。
- ```this.loader.data```の型は```URLVariables```。
- 例えば、以下のようなコードを書く。
```as3
this.loader.data.mode = "first";
this.loader.data.itemlist = "1001/サーベル/0/5/9/0/0/0/0/Rush/100/sword:numC:ran:cnt:frz:dog:blc//\n1002/ロングソード/0/6/12/0/4/0/0/Chilling/240/sword:frz:ran//\n .. (略) .. ";
```
- this.loader.dataに渡される、```chalist```、```enelist```、```itemlist```、```skilldata```、```talkdata```などのデータは"**一部**"復元して[data](/data)に置いているので、参考にして下さい。

>[!WARNING]
>AccessClassはアクセス終了後に破棄されます。AccessClass内に変数を定義する場合、値はアクセスの度に破棄されるので注意。

>[!WARNING]
>データベースの一部のデータには、仮データや推測データが含まれます。

>[!CAUTION]
>chalistの1～10番目には、解析が出来ていない謎仕様があります。chalistの1～10番目のアバターの値を空白にしてもしなくてもおかしなことが起こるので注意。

# 6. オリジナルクラスの追加
- AccessClassは、本来、イニシエダンジョンのサーバーと通信するクラスです。
- 現在は通信できないので、変わりに処理を行うクラス```AccessBypass```クラスを使います。

- まず、```AccessBypass```という名前のクラスを追加します。
- 次に、[AccessBypass](/src/AccessBypass.as)のコードをそのクラスにコピペします。

# 7. AccessClassの変更
- url_dataという変数を追加します。
```as3
public var url_data:Object;
```

- 344行目、access()の一番最後の行に以下のコードを追加します。
```as3
this.url_data = _loc3_;
```

- 353行目、loaderCompleteFunc()の最初の行に以下のコードを追加します。
```as3
var bypass:AccessBypass = new AccessBypass(this.Main);
this.loader.data = bypass.getLoaderData(this.url_data);
```
